

<!DOCTYPE html>
<html lang="zh-CN">
<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="description" content="做一个优雅的变态...">
    <title>局域网象棋游戏（C++实现，使用Socket，界面使用Win32，CodeBlocks+GCC编译） | maxuewei2</title>

    <!-- Open Graph -->
    <meta name="description" content="目录
成果
运行效果图


过程
1. 首先的问题是下棋的两端应该是什么样的？
2. 接下来的问题是怎么表示，怎么存储？
3. 然后应该怎么通信呢？


代码
main.cpp
chinese_chess.h
Server.h
Client.h


END">
<meta property="og:type" content="article">
<meta property="og:title" content="局域网象棋游戏（C++实现，使用Socket，界面使用Win32，CodeBlocks+GCC编译）">
<meta property="og:url" content="https://maxuewei2.github.io/2016/03/22/局域网象棋/index.html">
<meta property="og:site_name" content="maxuewei2">
<meta property="og:description" content="目录
成果
运行效果图


过程
1. 首先的问题是下棋的两端应该是什么样的？
2. 接下来的问题是怎么表示，怎么存储？
3. 然后应该怎么通信呢？


代码
main.cpp
chinese_chess.h
Server.h
Client.h


END">
<meta property="og:image" content="https://maxuewei2.github.io/imgs/xiangqi1.jpg">
<meta property="og:image" content="https://maxuewei2.github.io/imgs/xiangqi2.jpg">
<meta property="og:updated_time" content="2016-11-05T08:24:20.752Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="局域网象棋游戏（C++实现，使用Socket，界面使用Win32，CodeBlocks+GCC编译）">
<meta name="twitter:description" content="目录
成果
运行效果图


过程
1. 首先的问题是下棋的两端应该是什么样的？
2. 接下来的问题是怎么表示，怎么存储？
3. 然后应该怎么通信呢？


代码
main.cpp
chinese_chess.h
Server.h
Client.h


END">
<meta name="twitter:image" content="https://maxuewei2.github.io/imgs/xiangqi1.jpg">

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:undefined",
  "image": "/imgs/maxuewei2_avatar.png",
  "name": "maxuewei2",
  "url": "https://maxuewei2.github.io"
}
</script>
    <script>
    var algoliaEnabled = false;
    
</script>

    

    
    
        <link href="https://fonts.gmirror.org/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
    
    
    
        <!-- stylesheets list from config.yml -->
        
        <link rel="stylesheet" href="/css/aloha.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/magnific-popup.js/1.1.0/magnific-popup.min.css">
        
    

</head>
<body id="body" style="margin-bottom: 0;" class="pushable">

    <div class="ui top fixed menu">
        <a class="item" id="menu-icon"><i class="sidebar icon"></i></a>
    </div>

    <div id="menu-sidebar" class="ui left vertical sidebar menu">

    <div id="sidebar-top">
        <div class="content">
            <h3>maxuewei2</h3>
        </div>
    </div>
    <div class="ui container sidebar-card">
    <div class="ui people shape content">
        <div class="active side">
            <div class="ui card">
                <div class="image">
                    <img class="ui medium bordered image" src="/images/avatar.jpg">
                </div>
                <div class="content">
                    <a class="header">maxuewei2</a>
                    
                        <div class="meta">
                            做一个优雅的变态
                        </div>
                    
                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                        <div class="item">
                            <i class="marker icon" style="float: left"></i>
                            <div class="content">长春</div>
                        </div>
                        
                        
                    </div>

                </div>
                <div class="extra content">
                    <div class="ui list">
                        

                                <a href="https://github.com/maxuewei2"><i class="large github icon" style="float: left"></i></a>

                            

                                <a href="http://weibo.com/maxuewei2"><i class="large weibo icon" style="float: left"></i></a>

                            
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

    
    

    

    
    <a href="/index.html" class="item" >
        <i class="home icon"></i>
        首页
    </a>

    
    

    

    
    <a href="/about" class="item" >
        <i class="user icon"></i>
        关于
    </a>

    

    
</div>

    <div class="pusher body-content">
        <div id="content" class="ui main container">
            <!--<div class="ui one column grid">-->
                <!--<div class="column">-->
                    <!--<div class="ui main container">-->
                        <div id="post-局域网象棋" class="ui main container article-type-post">

    

    <div class="ui divided grid">

        <div class="two column row" id="article-content">

            <div class="thirteen wide computer thirteen wide tablet sixteen wide mobile column">
                

<h1 class="ui header">
    
    局域网象棋游戏（C++实现，使用Socket，界面使用Win32，CodeBlocks+GCC编译）
</h1>



                <div class="article-inner">

                    <div class="article-entry" itemprop="articleBody">
                        
                        <blockquote>
<ul class="ui list">
<li>&#x76EE;&#x5F55;<ul>
<li><a href="#chengguo">&#x6210;&#x679C;</a><ul>
<li><a href="#xiaoguo">&#x8FD0;&#x884C;&#x6548;&#x679C;&#x56FE;</a></li>
</ul>
</li>
<li><a href="#guocheng">&#x8FC7;&#x7A0B;</a><ul>
<li><a href="#liangduan">1. &#x9996;&#x5148;&#x7684;&#x95EE;&#x9898;&#x662F;&#x4E0B;&#x68CB;&#x7684;&#x4E24;&#x7AEF;&#x5E94;&#x8BE5;&#x662F;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#xFF1F;</a></li>
<li><a href="#cunchu">2. &#x63A5;&#x4E0B;&#x6765;&#x7684;&#x95EE;&#x9898;&#x662F;&#x600E;&#x4E48;&#x8868;&#x793A;&#xFF0C;&#x600E;&#x4E48;&#x5B58;&#x50A8;&#xFF1F;</a></li>
<li><a href="#tongxin">3. &#x7136;&#x540E;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x901A;&#x4FE1;&#x5462;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#daima">&#x4EE3;&#x7801;</a><ul>
<li><a href="#main">main.cpp</a></li>
<li><a href="#chess">chinese_chess.h</a></li>
<li><a href="#server">Server.h</a></li>
<li><a href="#client">Client.h</a></li>
</ul>
</li>
<li><a href="#end">END</a><a id="more"></a>
</li>
</ul>
</li>
</ul>
</blockquote>
<p>&#x2002;<br>&#x2002;<br>&#x2002;<br>&#x2002;</p>
<p></p><h2 id="chengguo">&#x6210;&#x679C;</h2><p></p>
<h3 id="xiaoguo">&#x8FD0;&#x884C;&#x6548;&#x679C;&#x56FE;</h3>

<p>&#x3000;&#x3000;&#x5DE6;&#x8FB9;&#x662F;&#x5728;&#x865A;&#x62DF;&#x673A;&#x91CC;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x53F3;&#x8FB9;&#x662F;&#x5728;Host&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x3002;<br><a class="magnific-img" href="/imgs/xiangqi1.jpg"><img src="/imgs/xiangqi1.jpg" alt="chengguo" class="ui centered image"></a><br><a class="magnific-img" href="/imgs/xiangqi2.jpg"><img src="/imgs/xiangqi2.jpg" alt="chengguo" class="ui centered image"></a></p>
<p></p><h2 id="guocheng">&#x8FC7;&#x7A0B;</h2><br>&#x3000;&#x3000;&#x8BB0;&#x4E0D;&#x8D77;&#x81EA;&#x5DF1;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5199;&#x8FD9;&#x4E2A;&#x8C61;&#x68CB;&#x6E38;&#x620F;&#x7684;&#xFF0C;&#x5927;&#x6982;&#x662F;&#x56E0;&#x4E3A;&#x521A;&#x5B66;&#x4E86;&#x70B9;&#x513F;Socket &#xFF0C;&#x6240;&#x4EE5;&#x60F3;&#x7528;&#x7528;&#xFF0C;&#x4E8E;&#x662F;&#x5C31;&#x5199;&#x4E2A;&#x5C40;&#x57DF;&#x7F51;&#x5BF9;&#x6218;&#x7684;&#x8C61;&#x68CB;&#x5427;&#x3002;&#x3002;&#x3002;<p></p>
<h3 id="liangduan">1.&#x9996;&#x5148;&#x7684;&#x95EE;&#x9898;&#x662F;&#x4E0B;&#x68CB;&#x7684;&#x4E24;&#x7AEF;&#x5E94;&#x8BE5;&#x662F;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#xFF1F;</h3>


<p>&#x3000;&#x3000;&#x6211;&#x5E0C;&#x671B;&#x4E0B;&#x68CB;&#x7684;&#x4E24;&#x4E2A;&#x4EBA;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x6240;&#x4EE5;&#x5C31;&#x4E0D;&#x80FD;&#x50CF;FTP&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#xFF0C;&#x800C;&#x53EA;&#x80FD;&#x6BCF;&#x4E2A;&#x7A0B;&#x5E8F;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x65E2;&#x662F;&#x5BA2;&#x6237;&#x7AEF;&#xFF08;Client&#xFF09;&#xFF0C;&#x53C8;&#x662F;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#xFF08;Server&#xFF09;&#x3002;&#x5728;&#x901A;&#x4FE1;&#x65F6;&#xFF0C;&#x5DF1;&#x65B9;&#x7684;Client &#x5411;&#x5BF9;&#x65B9;&#x7684;Server &#x53D1;&#x9001;&#x4FE1;&#x606F;&#xFF0C;&#x5BF9;&#x65B9;&#x7684;Client &#x5411;&#x5DF1;&#x65B9;&#x7684;Server &#x53D1;&#x9001;&#x4FE1;&#x606F;&#x3002;&#x4E24;&#x7AEF;&#x90FD;&#x5B58;&#x50A8;&#x68CB;&#x76D8;&#x4FE1;&#x606F;&#xFF0C;&#x901A;&#x8FC7;&#x901A;&#x4FE1;&#x4FDD;&#x6301;&#x68CB;&#x76D8;&#x4FE1;&#x606F;&#x7684;&#x4E00;&#x81F4;&#x3002;</p>
<p>&#x3000;&#x3000;&#x7136;&#x540E;&#x5462;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x7AEF;&#x70B9;&#x51FB;&#x754C;&#x9762;&#x79FB;&#x5B50;&#x4E4B;&#x540E;&#xFF0C;&#x5E94;&#x8BE5;&#x80FD;&#x901A;&#x77E5;&#x5BF9;&#x65B9;&#x8FDB;&#x884C;&#x76F8;&#x540C;&#x7684;&#x79FB;&#x52A8;&#x3002;</p>
<p>&#x3000;&#x3000;&#x7EFC;&#x5408;&#x4EE5;&#x4E0A;&#x4E24;&#x70B9;&#xFF0C;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x5E94;&#x8BE5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<p>&#x3000;&#x3000;&#x5F53;&#x5728;&#x754C;&#x9762;&#x4E0A;&#x70B9;&#x51FB;&#x68CB;&#x5B50;&#x65F6;&#xFF0C;&#x5148;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x662F;&#x5426;&#x8F6E;&#x5230;&#x81EA;&#x5DF1;&#x843D;&#x5B50;&#xFF0C;&#x5982;&#x679C;&#x662F;&#xFF0C;&#x5219;&#x8FDB;&#x884C;&#x79FB;&#x52A8;&#xFF0C;&#x66F4;&#x65B0;&#x754C;&#x9762;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;Client &#x5411;&#x5BF9;&#x65B9;Server &#x53D1;&#x9001;&#x79FB;&#x52A8;&#x4FE1;&#x606F;&#x3002;&#x5BF9;&#x65B9;Server &#x6536;&#x5230;&#x540E;&#xFF0C;&#x8FDB;&#x884C;&#x540C;&#x6837;&#x7684;&#x79FB;&#x52A8;&#xFF0C;&#x66F4;&#x65B0;&#x754C;&#x9762;&#x3002;</p>
<p>&#x3000;&#x3000;&#x8FD9;&#x91CC;&#x8981;&#x6C42;Server&#x80FD;&#x968F;&#x65F6;&#x63A5;&#x5230;&#x5BF9;&#x65B9;&#x53D1;&#x6765;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x6240;&#x4EE5;Server&#x7684;&#x76D1;&#x542C;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x7EBF;&#x7A0B;&#x3002;</p>
<h3 id="cunchu">2.&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x95EE;&#x9898;&#x662F;&#x600E;&#x4E48;&#x8868;&#x793A;&#xFF0C;&#x600E;&#x4E48;&#x5B58;&#x50A8;&#xFF1F;</h3>

<p>&#x3000;&#x3000;&#x68CB;&#x76D8;&#xFF0C;&#x5E94;&#x8BE5;&#x7528;&#x4E8C;&#x7EF4;&#x6570;&#x7EC4;&#x5B58;&#x50A8;&#x6BD4;&#x8F83;&#x597D;&#xFF0C;&#x6570;&#x7EC4;&#x5750;&#x6807;&#xFF08;&#x4EE5;&#x4E0B;&#x6240;&#x8BF4;&#x7684;&#x201D;&#x6570;&#x7EC4;&#x5750;&#x6807; &#x201C;&#x662F;&#x6307;&#x8BE5;&#x4E8C;&#x7EF4;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;(x,y)&#x6570;&#x5BF9;&#xFF09;&#x5BF9;&#x5E94;&#x68CB;&#x76D8;&#x5750;&#x6807;&#x3002;&#x90A3;&#x4E48;&#x6570;&#x7EC4;&#x91CC;&#x5B58;&#x50A8;&#x4EC0;&#x4E48;&#x5462;&#xFF0C;&#x4E00;&#x5171;&#x6709;&#x8ECA;&#x3001;&#x9A6C;&#x3001;&#x8C61;&#x3001;&#x58EB;&#x3001;&#x5C06;&#x3001;&#x7832;&#x3001;&#x5352;&#x4E03;&#x79CD;&#x68CB;&#x5B50;&#xFF0C;&#x90A3;&#x4E48;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x68CB;&#x5B50;&#x7C7B;&#x4F5C;&#x4E3A;&#x57FA;&#x7C7B;&#xFF0C;&#x7136;&#x540E;&#x8BBE;&#x7F6E;&#x4E03;&#x4E2A;&#x7C7B;&#x7EE7;&#x627F;&#x68CB;&#x5B50;&#x7C7B;&#xFF1F;&#x57FA;&#x7C7B;&#x6709;&#x4E00;&#x4E2A;move&#x51FD;&#x6570;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x7C7B;&#x91CD;&#x5199;&#x8BE5;&#x51FD;&#x6570;&#xFF1F;&#x4F46;&#x662F;&#x79FB;&#x52A8;&#x4F3C;&#x4E4E;&#x53EA;&#x662F;&#x6211;&#x7A0B;&#x5E8F;&#x7684;&#x4E00;&#x5C0F;&#x90E8;&#x5206;&#xFF0C;&#x8FD9;&#x6837;&#x4F3C;&#x4E4E;&#x6CA1;&#x5FC5;&#x8981;&#x3002;</p>
<p>&#x3000;&#x3000;&#x90A3;&#x4E48;&#x5B58;&#x50A8;&#x6574;&#x578B;&#x6570;&#x503C;&#xFF1F;&#x4E0D;&#x540C;&#x7684;&#x6570;&#x503C;&#x4EE3;&#x8868;&#x4E0D;&#x540C;&#x7684;&#x68CB;&#x5B50;&#xFF1F;&#x4F3C;&#x4E4E;&#x53EF;&#x4EE5;&#x3002;</p>
<p>&#x3000;&#x3000;&#x90A3;&#x4E48;&#x5C31;&#x7528;7&#x4E2A;&#x6570;&#x4EE3;&#x66FF;&#x4E03;&#x79CD;&#x68CB;&#x5B50;&#xFF0C;&#x4F46;&#x662F;&#x68CB;&#x5B50;&#x6709;&#x9ED1;&#x767D;&#x8272;&#xFF0C;&#x8981;&#x7528;&#x4E00;&#x4E2A;&#x6570;&#x8868;&#x793A;&#x68CB;&#x5B50;&#x7C7B;&#x578B;&#xFF08;&#x5373;&#x662F;&#x8ECA;&#x3001;&#x9A6C;&#x6216;&#x5176;&#x4ED6;&#xFF09;&#x548C;&#x68CB;&#x5B50;&#x989C;&#x8272;&#x4E24;&#x4E2A;&#x4FE1;&#x606F;&#xFF0C;&#x90A3;&#x5C31;&#x7528;BLANK =8&#x4EE3;&#x8868;&#x7A7A;&#x5B50;&#xFF0C;&#x9ED1;&#x65B9;&#x7684;&#x8ECA;&#x3001;&#x9A6C;&#x3001;&#x8C61;&#x3001;&#x58EB;&#x3001;&#x5C06;&#x3001;&#x7832;&#x3001;&#x5352;&#x5206;&#x522B;&#x4E3A;1&#x5230;7&#xFF0C;&#x767D;&#x65B9;&#x7684;&#x8ECA;&#x3001;&#x9A6C;&#x3001;&#x76F8;&#x3001;&#x58EB;&#x3001;&#x5E05;&#x3001;&#x70AE;&#x3001;&#x5175;&#x5206;&#x522B;&#x4E3A;9&#x5230;15&#x3002;</p>
<p>&#x3000;&#x3000;&#x8FD9;&#x6837;&#x5224;&#x65AD;&#x67D0;&#x6570;&#x7EC4;&#x5750;&#x6807;&#x4E0A;&#x68CB;&#x5B50;&#x7684;&#x989C;&#x8272;&#xFF0C;&#x5C31;&#x628A;&#x5176;&#x503C;&#x4E0E;BLANK &#x6BD4;&#x8F83;&#xFF0C;&#x5927;&#x4E8E;BLANK&#x4E3A;&#x767D;&#x8272;&#xFF0C;&#x5426;&#x5219;&#x4E3A;&#x9ED1;&#x8272;&#x3002;</p>
<p>&#x3000;&#x3000;&#x5224;&#x65AD;&#x67D0;&#x6570;&#x7EC4;&#x5750;&#x6807;&#x4E0A;&#x68CB;&#x5B50;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x5219;&#x5C06;&#x5176;&#x503C;&#x6A21;BLANK &#x3002;</p>
<p>&#x3000;&#x3000;&#x53E6;&#x5916;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0B;&#x68CB;&#x53CC;&#x65B9;&#x7684;&#x89C6;&#x89D2;&#x662F;&#x76F8;&#x53CD;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x68CB;&#x76D8;&#x5728;&#x5B58;&#x50A8;&#x65F6;&#x5E94;&#x8BE5;&#x662F;&#x76F8;&#x53CD;&#x7684;&#xFF0C;&#x79FB;&#x52A8;&#x65F6;&#x7684;&#x5750;&#x6807;&#x4E5F;&#x5E94;&#x8BE5;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#x3002;</p>
<h3 id="tongxin">3.&#x7136;&#x540E;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x901A;&#x4FE1;&#x5462;&#xFF1F;</h3>

<p>&#x3000;&#x3000;&#x6211;&#x5E0C;&#x671B;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x6253;&#x5F00;&#x540E;&#xFF0C;&#x5C31;&#x80FD;&#x627E;&#x5230;&#x5BF9;&#x65B9;&#xFF0C;&#x5E76;&#x786E;&#x5B9A;&#x8C01;&#x662F;&#x9ED1;&#x8272;&#xFF0C;&#x8C01;&#x662F;&#x767D;&#x8272;&#x3002;</p>
<p>&#x3000;&#x3000;&#x4E5F;&#x8BB8;&#x53EF;&#x4EE5;&#x8BA9;Client &#x5728;&#x8FD0;&#x884C;&#x4E4B;&#x540E;&#x5C31;&#x5BF9;&#x5C40;&#x57DF;&#x7F51;&#x8FDB;&#x884C;&#x7AEF;&#x53E3;&#x626B;&#x63CF;&#xFF0C;&#x7136;&#x540E;&#x7ED9;&#x51FA;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x6B64;&#x7A0B;&#x5E8F;&#x7684;IP &#x5730;&#x5740;&#x5217;&#x8868;&#xFF0C;&#x8BA9;&#x7528;&#x6237;&#x9009;&#x62E9;&#x8981;&#x8FDE;&#x63A5;&#x5230;&#x54EA;&#x4E2A;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x65B9;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x8FDE;&#x63A5;&#xFF0C;&#x5219;&#x5BF9;&#x65B9;&#x4F1A;&#x62D2;&#x7EDD;&#x6B64;&#x8FDE;&#x63A5;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x65B9;&#x6CA1;&#x6709;&#x8FDE;&#x63A5;&#xFF0C;&#x5219;&#x5BF9;&#x65B9;&#x7A0B;&#x5E8F;&#x4F1A;&#x5411;&#x5BF9;&#x65B9;&#x7528;&#x6237;&#x63D0;&#x793A;&#x8BE5;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#xFF0C;&#x5982;&#x679C;&#xFF0C;&#x5BF9;&#x65B9;&#x7528;&#x6237;&#x540C;&#x610F;&#xFF0C;&#x5219;&#x8FDE;&#x63A5;&#x5EFA;&#x7ACB;&#xFF0C;&#x5426;&#x5219;&#x4F9D;&#x7136;&#x662F;&#x62D2;&#x7EDD;&#x6B64;&#x8FDE;&#x63A5;&#x3002;</p>
<p>&#x3000;&#x3000;&#x4F46;&#x662F;&#xFF0C;&#x6211;&#x6CA1;&#x6709;&#x91C7;&#x7528;&#x4EE5;&#x4E0A;&#x6240;&#x8FF0;&#x65B9;&#x6CD5;&#xFF08;&#x56E0;&#x4E3A;&#x592A;&#x590D;&#x6742;&#xFF0C;&#x6211;&#x8FD8;&#x662F;&#x5148;&#x505A;&#x597D;&#x4E3B;&#x4F53;&#x5DE5;&#x4F5C;&#x5427;=_=&#xFF09;</p>
<p>&#x3000;&#x3000;&#x6240;&#x4EE5;&#x5728;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;&#x8FD0;&#x884C;&#x540E;&#xFF0C;&#x4F1A;&#x8BA9;&#x7528;&#x6237;&#x8F93;&#x5165;&#x5BF9;&#x65B9;&#x7684;IP &#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;Server &#x5F00;&#x59CB;&#x76D1;&#x542C;&#x3002;&#x4E4B;&#x540E;Client &#x5F00;&#x59CB;&#x5411;&#x5BF9;&#x65B9;&#x53D1;&#x51FA;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x3002;</p>
<p>&#x3000;&#x3000;Server &#x76D1;&#x542C;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x6536;&#x5230;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#xFF0C;&#x5C31;&#x770B;&#x5BF9;&#x65B9;&#x7684;IP &#x5730;&#x5740;&#x662F;&#x5426;&#x662F;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;IP &#x5730;&#x5740;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;&#xFF0C;&#x8BF4;&#x660E;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x4E0D;&#x662F;&#x7528;&#x6237;&#x6240;&#x5E0C;&#x671B;&#x7684;&#x5BF9;&#x65B9;&#x53D1;&#x9001;&#x7684;&#xFF0C;&#x90A3;&#x5C31;&#x7EE7;&#x7EED;&#x76D1;&#x542C;&#x3002;</p>
<p>&#x3000;&#x3000;Client &#x8BF7;&#x6C42;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x65B9;&#x540C;&#x610F;&#x4E86;&#xFF0C;&#x5C31;&#x8981;&#x5F00;&#x59CB;&#x786E;&#x5B9A;&#x81EA;&#x5DF1;&#x7684;&#x989C;&#x8272;&#x4E86;&#x3002;</p>
<p>&#x3000;&#x3000;&#x786E;&#x5B9A;&#x989C;&#x8272;&#x8FD9;&#x91CC;&#x56F0;&#x6270;&#x4E86;&#x6211;&#x5F88;&#x4E45;&#xFF0C;&#x6700;&#x540E;&#x91C7;&#x7528;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<ul class="ui list">
<li>&#x6838;&#x5FC3;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x8C01;&#x5148;&#x53D1;&#x51FA;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#xFF0C;&#x8C01;&#x5C31;&#x662F;&#x9ED1;&#x8272;&#x3002;</li>
<li>&#x4E5F;&#x5C31;&#x662F;&#x5728;Client &#x8FDE;&#x63A5;&#x4E0A;&#x5BF9;&#x65B9;&#x4E4B;&#x540E;&#xFF0C;&#x8981;&#x5224;&#x65AD;Server &#x662F;&#x4E0D;&#x662F;&#x5DF2;&#x7ECF;&#x8FDE;&#x63A5;&#x4E86;&#x5BF9;&#x65B9;&#xFF0C;&#x5982;&#x679C;Server &#x5DF2;&#x8FDE;&#x63A5;&#xFF0C;&#x5C31;&#x8BF4;&#x660E;&#x662F;&#x5BF9;&#x65B9;&#x5148;&#x53D1;&#x51FA;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x65B9;&#x5C31;&#x662F;&#x9ED1;&#x8272;&#xFF0C;&#x81EA;&#x5DF1;&#x5C31;&#x8BBE;&#x4E3A;&#x767D;&#x8272;&#x3002;&#x5982;&#x679C;Server &#x6CA1;&#x6709;&#x8FDE;&#x63A5;&#xFF0C;&#x5C31;&#x8BF4;&#x660E;&#x81EA;&#x5DF1;&#x5148;&#x8FDE;&#x63A5;&#x4E0A;&#x4E86;&#x5BF9;&#x65B9;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x81EA;&#x5DF1;&#x662F;&#x9ED1;&#x8272;&#x3002;</li>
</ul>
<p>&#x3000;&#x3000;&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x7F16;&#x7801;&#x524D;&#x53CA;&#x7F16;&#x7801;&#x65F6;&#x7684;&#x5927;&#x81F4;&#x60F3;&#x6CD5;&#x3002;</p>
<p></p><h2 id="daima">&#x4EE3;&#x7801;</h2><p></p>
<h3 id="main">main.cpp</h3>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(UNICODE) &amp;&amp; !defined(_UNICODE)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _UNICODE</span></div><div class="line"><span class="meta">#<span class="meta-keyword">elif</span> defined(_UNICODE) &amp;&amp; !defined(UNICODE)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> UNICODE</span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tchar.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;chinese_chess.h&quot;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Server.h&quot;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Client.h&quot;</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> WIDTH 400       <span class="comment">//&#x754C;&#x9762;&#x5BBD;&#x5EA6;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> HEIGHT 400      <span class="comment">//&#x754C;&#x9762;&#x9AD8;&#x5EA6;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ZERO_X 50       <span class="comment">//&#x68CB;&#x76D8;&#x5DE6;&#x8FB9;&#x754C;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ZERO_Y 50       <span class="comment">//&#x68CB;&#x76D8;&#x4E0A;&#x8FB9;&#x754C;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PIECE_BKCOLOR    RGB(175,143,89)   <span class="comment">//&#x68CB;&#x5B50;&#x80CC;&#x666F;&#x8272;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PIECE_WH 30        <span class="comment">//&#x68CB;&#x76D8;&#x6BCF;&#x4E2A;&#x683C;&#x5B50;&#x7684;&#x5BBD;&#x5EA6;&#x548C;&#x9AD8;&#x5EA6;</span></span></div><div class="line"></div><div class="line">HWND hwnd;               <span class="comment">/* This is the handle for our window */</span></div><div class="line"><span class="keyword">char</span>* ots_ip;           <span class="comment">//&#x5B58;&#x50A8;&#x5BF9;&#x65B9;IP&#x5730;&#x5740;&#x7684;&#x5B57;&#x7B26;&#x4E32;</span></div><div class="line"><span class="keyword">int</span> port;</div><div class="line"><span class="keyword">bool</span> is_connect_alive=<span class="literal">false</span>;        <span class="comment">//&#x662F;&#x5426;&#x8FDE;&#x63A5;&#x5230;&#x5BF9;&#x65B9;</span></div><div class="line">Board * chess_board;          <span class="comment">//&#x68CB;&#x76D8;</span></div><div class="line">Server *server;</div><div class="line">Client *client;</div><div class="line"><span class="keyword">int</span> chess_sx=<span class="number">-1</span>;        <span class="comment">//&#x79FB;&#x52A8;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;&#x7684;&#x6570;&#x7EC4;&#x5750;&#x6807;</span></div><div class="line"><span class="keyword">int</span> chess_sy=<span class="number">-1</span>;</div><div class="line"><span class="keyword">int</span> chess_dx=<span class="number">-1</span>;        <span class="comment">//&#x79FB;&#x52A8;&#x76EE;&#x6807;&#x4F4D;&#x7F6E;&#x7684;&#x6570;&#x7EC4;&#x5750;&#x6807;</span></div><div class="line"><span class="keyword">int</span> chess_dy=<span class="number">-1</span>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/*  Declare Windows procedure  */</span></div><div class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProcedure</span> <span class="params">(HWND, UINT, WPARAM, LPARAM)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">/*  Make the class name into a global variable  */</span></div><div class="line">TCHAR szClassName[ ] = _T(<span class="string">&quot;Chinese Chess&quot;</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> WINAPI <span class="title">WinMain</span> <span class="params">(HINSTANCE hThisInstance,</span></span></div><div class="line">                    HINSTANCE hPrevInstance,</div><div class="line">                    LPSTR lpszArgument,</div><div class="line">                    <span class="keyword">int</span> nCmdShow) {</div><div class="line">    MSG messages;            <span class="comment">/* Here messages to the application are saved */</span></div><div class="line">    WNDCLASSEX wincl;        <span class="comment">/* Data structure for the windowclass */</span></div><div class="line"></div><div class="line">    <span class="comment">/* The Window structure */</span></div><div class="line">    wincl.hInstance = hThisInstance;</div><div class="line">    wincl.lpszClassName = szClassName;</div><div class="line">    wincl.lpfnWndProc = WindowProcedure;      <span class="comment">/* This function is called by windows */</span></div><div class="line">    wincl.style = CS_DBLCLKS;                 <span class="comment">/* Catch double-clicks */</span></div><div class="line">    wincl.cbSize = <span class="keyword">sizeof</span> (WNDCLASSEX);</div><div class="line"></div><div class="line">    <span class="comment">/* Use default icon and mouse-pointer */</span></div><div class="line">    wincl.hIcon = LoadIcon (<span class="literal">NULL</span>, IDI_APPLICATION);</div><div class="line">    wincl.hIconSm = LoadIcon (<span class="literal">NULL</span>, IDI_APPLICATION);</div><div class="line">    wincl.hCursor = LoadCursor (<span class="literal">NULL</span>, IDC_ARROW);</div><div class="line">    wincl.lpszMenuName = <span class="literal">NULL</span>;                 <span class="comment">/* No menu */</span></div><div class="line">    wincl.cbClsExtra = <span class="number">0</span>;                      <span class="comment">/* No extra bytes after the window class */</span></div><div class="line">    wincl.cbWndExtra = <span class="number">0</span>;                      <span class="comment">/* structure or the window instance */</span></div><div class="line">    <span class="comment">/* Use Windows&apos;s default colour as the background of the window */</span></div><div class="line">    wincl.hbrBackground = (HBRUSH) COLOR_BACKGROUND;</div><div class="line"></div><div class="line">    <span class="comment">/* Register the window class, and if it fails quit the program */</span></div><div class="line">    <span class="keyword">if</span> (!RegisterClassEx (&amp;wincl))</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* The class is registered, let&apos;s create the program*/</span></div><div class="line">    hwnd = CreateWindowEx (</div><div class="line">               <span class="number">0</span>,                   <span class="comment">/* Extended possibilites for variation */</span></div><div class="line">               szClassName,         <span class="comment">/* Classname */</span></div><div class="line">               _T(<span class="string">&quot;Chinese Chess&quot;</span>),       <span class="comment">/* Title Text */</span></div><div class="line">               WS_OVERLAPPEDWINDOW, <span class="comment">/* default window */</span></div><div class="line">               CW_USEDEFAULT,       <span class="comment">/* Windows decides the position */</span></div><div class="line">               CW_USEDEFAULT,       <span class="comment">/* where the window ends up on the screen */</span></div><div class="line">               WIDTH,                 <span class="comment">/* The programs width */</span></div><div class="line">               HEIGHT,                 <span class="comment">/* and height in pixels */</span></div><div class="line">               HWND_DESKTOP,        <span class="comment">/* The window is a child-window to desktop */</span></div><div class="line">               <span class="literal">NULL</span>,                <span class="comment">/* No menu */</span></div><div class="line">               hThisInstance,       <span class="comment">/* Program Instance handler */</span></div><div class="line">               <span class="literal">NULL</span>                 <span class="comment">/* No Window Creation data */</span></div><div class="line">           );</div><div class="line"></div><div class="line">    <span class="comment">/* Make the window visible on the screen */</span></div><div class="line">    ShowWindow (hwnd, nCmdShow);</div><div class="line"></div><div class="line">    <span class="comment">/* Run the message loop. It will run until GetMessage() returns 0 */</span></div><div class="line">    <span class="keyword">while</span> (GetMessage (&amp;messages, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">0</span>)) {</div><div class="line">        <span class="comment">/* Translate virtual-key messages into character messages */</span></div><div class="line">        TranslateMessage(&amp;messages);</div><div class="line">        <span class="comment">/* Send message to WindowProcedure */</span></div><div class="line">        DispatchMessage(&amp;messages);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* The program return-value is 0 - The value that PostQuitMessage() gave */</span></div><div class="line">    <span class="keyword">return</span> messages.wParam;</div><div class="line">}</div><div class="line"><span class="comment">//&#x628A;&#x6570;&#x7EC4;&#x5750;&#x6807;&#x8F6C;&#x6362;&#x4E3A;&#x754C;&#x9762;&#x5750;&#x6807;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">xy_to_pixel</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span>*pixelx,<span class="keyword">int</span> *pixely)</span> </span>{</div><div class="line">    *pixely=x*PIECE_WH+ZERO_Y;</div><div class="line">    *pixelx=y*PIECE_WH+ZERO_X;</div><div class="line">}</div><div class="line"><span class="comment">//&#x628A;&#x754C;&#x9762;&#x5750;&#x6807;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x7EC4;&#x5750;&#x6807;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pixel_to_xy</span><span class="params">(<span class="keyword">int</span> pixelx,<span class="keyword">int</span> pixely,<span class="keyword">int</span>*x,<span class="keyword">int</span> *y)</span> </span>{</div><div class="line">    <span class="keyword">int</span> r=PIECE_WH/<span class="number">2</span>;</div><div class="line">    *y=(pixelx-(ZERO_X-r))/PIECE_WH;</div><div class="line">    *x=(pixely-(ZERO_Y-r))/PIECE_WH;</div><div class="line">}</div><div class="line"><span class="comment">//&#x4EE5;&#x6570;&#x7EC4;&#x5750;&#x6807;&#x753B;&#x7EBF;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw_line</span><span class="params">(HDC hdc,<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">    <span class="keyword">int</span> psx,psy,pdx,pdy;</div><div class="line">    xy_to_pixel(sx,sy,&amp;psx,&amp;psy);</div><div class="line">    xy_to_pixel(dx,dy,&amp;pdx,&amp;pdy);</div><div class="line">    MoveToEx (hdc, psx,psy, <span class="literal">NULL</span>) ;</div><div class="line">    LineTo (hdc, pdx, pdy) ;</div><div class="line">}</div><div class="line"><span class="comment">//&#x4EE5;&#x6570;&#x7EC4;&#x5750;&#x6807;&#x753B;&#x68CB;&#x5B50;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">paint_piece</span><span class="params">(HDC hdc,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> color,<span class="keyword">int</span> type)</span> </span>{</div><div class="line">    <span class="keyword">static</span> HBRUSH  piece_brush =CreateSolidBrush (PIECE_BKCOLOR);    <span class="comment">//&#x68CB;&#x5B50;&#x7684;&#x80CC;&#x666F;&#x8272;</span></div><div class="line">    <span class="keyword">if</span>(type==<span class="number">0</span>||color==BLANK)<span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">int</span> px,py;</div><div class="line">    xy_to_pixel(x,y,&amp;px,&amp;py);</div><div class="line">    <span class="keyword">int</span> r=PIECE_WH/<span class="number">2</span>;</div><div class="line">    SelectObject (hdc,piece_brush ) ;</div><div class="line">    Ellipse(hdc,px-r,py-r,px+r,py+r);</div><div class="line">    <span class="keyword">char</span> *text=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">5</span>];</div><div class="line">    <span class="keyword">switch</span>(type) {</div><div class="line">    <span class="keyword">case</span> JU:</div><div class="line">        <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x8ECA;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> MA:</div><div class="line">        <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x9A6C;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> XIANG:</div><div class="line">        <span class="keyword">if</span>(color==BLACK)<span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x8C61;&quot;</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x76F8;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> SHI:</div><div class="line">        <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x58EB;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> JIANG:</div><div class="line">        <span class="keyword">if</span>(color==BLACK)<span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x5C06;&quot;</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x5E05;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> PAO:</div><div class="line">        <span class="keyword">if</span>(color==BLACK)<span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x7832;&quot;</span>);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x70AE;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> ZU:</div><div class="line">        <span class="keyword">if</span>(color==BLACK)<span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x5352;&quot;</span>);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">strcpy</span>(text,<span class="string">&quot;&#x5175;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">        <span class="built_in">strcpy</span>(text,<span class="string">&quot;&quot;</span>);</div><div class="line">    }</div><div class="line">    SetBkColor(hdc,PIECE_BKCOLOR);<span class="comment">//&#x8BBE;&#x7F6E;&#x6587;&#x5B57;&#x80CC;&#x666F;&#x8272;</span></div><div class="line">    <span class="keyword">if</span>(color==BLACK) {</div><div class="line">        SetTextColor(hdc,RGB(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>));       <span class="comment">//&#x8BBE;&#x7F6E;&#x6587;&#x5B57;&#x989C;&#x8272;</span></div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        SetTextColor(hdc,RGB(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>));</div><div class="line">    }</div><div class="line">    TextOut (hdc, px-r/<span class="number">2</span>, py-r/<span class="number">2</span>,text , <span class="built_in">strlen</span>(<span class="string">&quot;&#x9A6C;&quot;</span>)) ;</div><div class="line">    <span class="keyword">delete</span> text;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span>* <span class="title">main_listen</span><span class="params">(<span class="keyword">void</span> *)</span> </span>{</div><div class="line">    server-&gt;listen_message();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="comment">//&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#xFF0C;&#x4F7F;server&#x5F00;&#x59CB;&#x76D1;&#x542C;</span></div><div class="line"><span class="function"><span class="keyword">bool</span>  <span class="title">start_listen</span><span class="params">()</span> </span>{</div><div class="line">    <span class="keyword">pthread_t</span> listen_p;</div><div class="line">    <span class="keyword">int</span> ret;</div><div class="line">    ret= pthread_create( &amp;listen_p,  <span class="literal">NULL</span>, main_listen,<span class="literal">NULL</span> ); <span class="comment">//</span></div><div class="line">    <span class="keyword">if</span>( ret != <span class="number">0</span> ) { <span class="comment">//&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6210;&#x529F;&#x8FD4;&#x56DE;0</span></div><div class="line">        <span class="comment">//printf(&quot;pthread_create error:error_code=%d\n&quot;,ret );</span></div><div class="line">        handle_error(THREAD_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span>* <span class="title">chess_connect</span><span class="params">(<span class="keyword">void</span> *)</span> </span>{</div><div class="line">    server=<span class="keyword">new</span> Server();<span class="comment">//&#x521B;&#x5EFA;Server&#x5BF9;&#x8C61;</span></div><div class="line">    client=<span class="keyword">new</span> Client(); <span class="comment">//&#x521B;&#x5EFA;Client&#x5BF9;&#x8C61;&#xFF0C;</span></div><div class="line">    start_listen();             <span class="comment">//&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#xFF0C;server&#x5F00;&#x59CB;&#x76D1;&#x542C;</span></div><div class="line">    <span class="comment">//Sleep(100);</span></div><div class="line">    client-&gt;connect_to_ots();  <span class="comment">//client&#x5F00;&#x59CB;&#x8FDE;&#x63A5;&#x5BF9;&#x65B9;server&#xFF0C;&#x8FDE;&#x63A5;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;</span></div><div class="line">    InvalidateRect(hwnd,<span class="literal">NULL</span>,<span class="literal">true</span>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">    <span class="keyword">pthread_t</span> connect_p;</div><div class="line">    <span class="keyword">int</span> ret;</div><div class="line">    ret= pthread_create( &amp;connect_p,  <span class="literal">NULL</span>, chess_connect,<span class="literal">NULL</span>); <span class="comment">//</span></div><div class="line">    <span class="keyword">if</span>( ret != <span class="number">0</span> ) { <span class="comment">//&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6210;&#x529F;&#x8FD4;&#x56DE;0</span></div><div class="line">        <span class="comment">//printf(&quot;pthread_create error:error_code=%d\n&quot;,ret );</span></div><div class="line">        handle_error(THREAD_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/*  This function is called by the Windows function DispatchMessage()  */</span></div><div class="line"></div><div class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProcedure</span> <span class="params">(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</span> </span>{</div><div class="line">    <span class="keyword">static</span> POINT mouse;</div><div class="line">    <span class="keyword">static</span> HDC hdc;</div><div class="line">    <span class="keyword">static</span> PAINTSTRUCT ps ;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> iofip=<span class="number">0</span>;     <span class="comment">//index of ots_ip</span></div><div class="line">    <span class="keyword">switch</span> (message) {                <span class="comment">/* handle the messages */</span></div><div class="line">    <span class="keyword">case</span> WM_CREATE: {</div><div class="line">        port=<span class="number">35536</span>;</div><div class="line">        ots_ip=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">20</span>];</div><div class="line">        <span class="built_in">strcpy</span>(ots_ip,<span class="string">&quot;&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> WM_KEYDOWN:<span class="comment">//&#x8BC6;&#x522B;&#x6309;&#x952E;&#xFF0C;&#x663E;&#x793A;&#x8F93;&#x5165;&#x7684;&#x5185;&#x5BB9;&#xFF08;&#x5BF9;&#x65B9;IP&#x5730;&#x5740;&#xFF09;</span></div><div class="line">        <span class="keyword">if</span>(wParam==<span class="number">13</span>) {<span class="comment">//&#x5982;&#x679C;&#x662F;ENTER&#xFF0C;&#x5219;&#x521D;&#x59CB;&#x5316;server&#x3001;client&#xFF0C;&#x5E76;&#x5F00;&#x59CB;&#x8FDE;&#x63A5;&#xFF0C;&#x8FDE;&#x63A5;&#x6210;&#x529F;&#x540E;&#x521D;&#x59CB;&#x5316;board</span></div><div class="line">            init();</div><div class="line">            Sleep(<span class="number">100</span>);</div><div class="line">            InvalidateRect(hwnd,<span class="literal">NULL</span>,<span class="literal">true</span>);</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(wParam==VK_BACK) {<span class="comment">//&#x5220;&#x9664;&#x952E;</span></div><div class="line">            <span class="keyword">if</span>(iofip==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            iofip--;</div><div class="line">            ots_ip[iofip]=<span class="string">&apos;\0&apos;</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(wParam&lt;<span class="number">106</span>&amp;&amp;wParam&gt;<span class="number">95</span>) {<span class="comment">//&#x5C0F;&#x952E;&#x76D8;&#x6570;&#x5B57;&#x952E;</span></div><div class="line">            wParam-=<span class="number">48</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(wParam&lt;<span class="number">58</span>&amp;&amp;wParam&gt;<span class="number">47</span>) {<span class="comment">//&#x4E3B;&#x952E;&#x76D8;&#x6570;&#x5B57;&#x952E;</span></div><div class="line">            ots_ip[iofip]=<span class="string">&apos;0&apos;</span><span class="number">-48</span>+wParam;</div><div class="line">            iofip++;</div><div class="line">            ots_ip[iofip]=<span class="string">&apos;\0&apos;</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(wParam==<span class="number">110</span>||wParam==<span class="number">229</span>) {<span class="comment">//&#x5C0F;&#x6570;&#x70B9;&#x952E;&#xFF0C;&#x5C0F;&#x952E;&#x76D8;110&#xFF0C;&#x4E3B;&#x952E;&#x76D8;229</span></div><div class="line">            ots_ip[iofip]=<span class="string">&apos;.&apos;</span>;</div><div class="line">            iofip++;</div><div class="line">            ots_ip[iofip]=<span class="string">&apos;\0&apos;</span>;</div><div class="line">        }</div><div class="line">        InvalidateRect(hwnd,<span class="literal">NULL</span>,<span class="literal">true</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> WM_PAINT: {</div><div class="line">        hdc=BeginPaint (hwnd,&amp;ps) ;</div><div class="line">        SetBkColor(hdc,RGB(<span class="number">200</span>,<span class="number">200</span>,<span class="number">200</span>));</div><div class="line">        <span class="keyword">if</span>(chess_board==<span class="literal">NULL</span>) {<span class="comment">//&#x663E;&#x793A;&#x8F93;&#x5165;&#x7684;IP&#x5730;&#x5740;</span></div><div class="line">            <span class="keyword">char</span> tip[<span class="number">20</span>]=<span class="string">&quot;&#x8BF7;&#x8F93;&#x5165;&#x5BF9;&#x65B9;IP&#x5730;&#x5740;&#xFF1A;&quot;</span>;</div><div class="line">            Rectangle(hdc,WIDTH/<span class="number">5</span><span class="number">-20</span>,HEIGHT/<span class="number">2</span><span class="number">-10</span>,WIDTH/<span class="number">5</span>*<span class="number">4</span>,HEIGHT/<span class="number">2</span>+<span class="number">20</span>);</div><div class="line">            TextOut(hdc,WIDTH/<span class="number">5</span>,HEIGHT/<span class="number">2</span><span class="number">-50</span>,tip,<span class="built_in">strlen</span>(tip));</div><div class="line">            TextOut(hdc,WIDTH/<span class="number">5</span>,HEIGHT/<span class="number">2</span>,ots_ip,<span class="built_in">strlen</span>(ots_ip));</div><div class="line">            <span class="keyword">if</span>(server!=<span class="literal">NULL</span>) {             <span class="comment">//board==NULL&#x800C;server!=NULL&#x8868;&#x793A;&#x6B63;&#x5728;&#x8FDE;&#x63A5;&#x8FC7;&#x7A0B;&#x4E2D;</span></div><div class="line">                <span class="keyword">char</span> tip[<span class="number">20</span>]=<span class="string">&quot;&#x6B63;&#x5728;&#x8FDE;&#x63A5;......&quot;</span>;</div><div class="line">                TextOut(hdc,WIDTH/<span class="number">5</span>,HEIGHT/<span class="number">2</span>+<span class="number">50</span>,tip,<span class="built_in">strlen</span>(tip));</div><div class="line">            }</div><div class="line">            EndPaint(hwnd,&amp;ps);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">char</span> text[<span class="number">10</span>]=<span class="string">&quot;&#x4F60;&#x7684;&#x989C;&#x8272;:&quot;</span>;</div><div class="line">        <span class="keyword">if</span>(chess_board-&gt;get_color()==BLACK) {</div><div class="line">            <span class="built_in">strcat</span>(text,<span class="string">&quot; &#x9ED1;&quot;</span>);</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="built_in">strcat</span>(text,<span class="string">&quot; &#x767D;&quot;</span>);</div><div class="line">        }</div><div class="line">        TextOut (hdc, <span class="number">0</span>, <span class="number">0</span>,text , <span class="built_in">strlen</span>(text)) ;</div><div class="line">        <span class="keyword">int</span> M=chess_board-&gt;get_M();</div><div class="line">        <span class="keyword">int</span> N=chess_board-&gt;get_N();</div><div class="line">        <span class="comment">//&#x753B;&#x68CB;&#x76D8;</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;M; i++) {</div><div class="line">            draw_line(hdc,i,<span class="number">0</span>,i,N<span class="number">-1</span>);</div><div class="line">        }</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;N; i++) {</div><div class="line">            draw_line(hdc,<span class="number">0</span>,i,N/<span class="number">2</span>,i);</div><div class="line">        }</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;N; i++) {</div><div class="line">            draw_line(hdc,N/<span class="number">2</span>+<span class="number">1</span>,i,N,i);</div><div class="line">        }</div><div class="line">        draw_line(hdc,<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>);</div><div class="line">        draw_line(hdc,<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>);</div><div class="line">        draw_line(hdc,<span class="number">9</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">5</span>);</div><div class="line">        draw_line(hdc,<span class="number">7</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">5</span>);</div><div class="line">        draw_line(hdc,<span class="number">4</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>);</div><div class="line">        draw_line(hdc,<span class="number">4</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">8</span>);</div><div class="line">        <span class="comment">//&#x753B;&#x68CB;&#x5B50;</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;M; i++) {</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;N; j++) {</div><div class="line">                paint_piece(hdc,i,j,chess_board-&gt;get_color(i,j),chess_board-&gt;get_type(i,j));</div><div class="line">            }</div><div class="line">        }</div><div class="line">        EndPaint(hwnd,&amp;ps);</div><div class="line">    }</div><div class="line">    <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> WM_LBUTTONUP: {</div><div class="line">        <span class="keyword">if</span>(chess_board==<span class="literal">NULL</span>)<span class="keyword">break</span>;</div><div class="line">        <span class="keyword">if</span>(!chess_board-&gt;is_my_turn())<span class="keyword">break</span>;<span class="comment">//&#x5F53;&#x524D;&#x6CA1;&#x8F6E;&#x5230;&#x81EA;&#x5DF1;&#x4E0B;&#x68CB;</span></div><div class="line">        GetCursorPos(&amp;mouse);<span class="comment">//&#x83B7;&#x53D6;&#x9F20;&#x6807;&#x7684;&#x5C4F;&#x5E55;&#x5750;&#x6807;</span></div><div class="line">        ScreenToClient(hwnd,&amp;mouse);<span class="comment">//&#x8F6C;&#x6362;&#x4E3A;&#x754C;&#x9762;&#x5750;&#x6807;</span></div><div class="line">        <span class="keyword">int</span> x,y;</div><div class="line">        pixel_to_xy(mouse.x,mouse.y,&amp;x,&amp;y);<span class="comment">//&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x7EC4;&#x5750;&#x6807;</span></div><div class="line">        <span class="keyword">if</span>(chess_board-&gt;get_color(x,y)==chess_board-&gt;get_color()) {<span class="comment">//&#x70B9;&#x51FB;&#x7684;&#x662F;&#x81EA;&#x5DF1;&#x7684;&#x68CB;&#x5B50;</span></div><div class="line">            chess_sx=x;</div><div class="line">            chess_sy=y;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(chess_sx==<span class="number">-1</span>||chess_sy==<span class="number">-1</span>) {<span class="comment">//&#x8D77;&#x59CB;&#x5750;&#x6807;&#x672A;&#x8D4B;&#x503C;&#x4E14;&#x70B9;&#x51FB;&#x7684;&#x4E0D;&#x662F;&#x81EA;&#x5DF1;&#x7684;&#x68CB;&#x5B50;&#xFF0C;&#x5219;break</span></div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        }</div><div class="line">        chess_dx=x;</div><div class="line">        chess_dy=y;</div><div class="line">        <span class="keyword">if</span>(chess_board-&gt;my_move_piece(chess_sx,chess_sy,chess_dx,chess_dy)) { <span class="comment">//&#x5982;&#x679C;&#x79FB;&#x52A8;&#x68CB;&#x5B50;&#x5408;&#x6CD5;</span></div><div class="line">            client-&gt;send_message(<span class="string">&quot;move&quot;</span>,chess_sx,chess_sy,chess_dx,chess_dy);   <span class="comment">//&#x5411;&#x5BF9;&#x65B9;&#x53D1;&#x9001;&#x79FB;&#x5B50;&#x4FE1;&#x606F;</span></div><div class="line">            InvalidateRect(hwnd,<span class="literal">NULL</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">if</span>(chess_board-&gt;get_is_win()==WIN) {</div><div class="line"></div><div class="line">                chess_board-&gt;init();<span class="comment">//&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x68CB;&#x76D8;&#xFF0C;&#x91CD;&#x4E0B;&#x4E00;&#x76D8;</span></div><div class="line">                MessageBox(hwnd,<span class="string">&quot;&#x4F60;&#x8D62;&#x4E86;&quot;</span>,<span class="string">&quot;&#x83B7;&#x80DC;&#xFF01;&quot;</span>,<span class="literal">NULL</span>);</div><div class="line">                InvalidateRect(hwnd,<span class="literal">NULL</span>,<span class="literal">true</span>);</div><div class="line">            }</div><div class="line">        }</div><div class="line">        chess_sx=<span class="number">-1</span>;</div><div class="line">        chess_sy=<span class="number">-1</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">case</span> WM_DESTROY:</div><div class="line">        <span class="keyword">if</span>(server!=<span class="literal">NULL</span>)server-&gt;close();</div><div class="line">        <span class="keyword">if</span>(client!=<span class="literal">NULL</span>)client-&gt;close();</div><div class="line">        PostQuitMessage (<span class="number">0</span>);       <span class="comment">/* send a WM_QUIT to the message queue */</span></div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">default</span>:                      <span class="comment">/* for messages that we don&apos;t deal with */</span></div><div class="line">        <span class="keyword">return</span> DefWindowProc (hwnd, message, wParam, lParam);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<h3 id="chess">chinese_chess.h</h3>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> CHINESE_CHESS_H_INCLUDED</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> CHINESE_CHESS_H_INCLUDED</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> JU 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MA 2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> XIANG 3</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SHI 4</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> JIANG 5</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PAO 6</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ZU 7</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BLANK 8 <span class="comment">//&#x7A7A;&#x5B50;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BLACK -1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> WHITE 1</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> WIN 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LOSE -1</span></div><div class="line"><span class="keyword">class</span> Board {</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">bool</span> turn;   <span class="comment">//&#x662F;&#x5426;&#x8F6E;&#x5230;&#x81EA;&#x5DF1;&#x4E0B;&#x68CB;</span></div><div class="line">    <span class="keyword">int</span> color;  <span class="comment">//&#x81EA;&#x5DF1;&#x7684;&#x989C;&#x8272;</span></div><div class="line">    <span class="keyword">int</span> M,N;        <span class="comment">//&#x68CB;&#x76D8;&#x884C;&#x6570;&#x3001;&#x5217;&#x6570;</span></div><div class="line">    <span class="keyword">int</span> **b;    <span class="comment">//&#x4E8C;&#x7EF4;&#x6570;&#x7EC4;</span></div><div class="line">    <span class="keyword">int</span> is_win;     <span class="comment">//&#x662F;&#x5426;&#x80DC;&#x5229;</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_out</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>{<span class="comment">//&#x5750;&#x6807;&#x662F;&#x5426;&#x51FA;&#x754C;</span></div><div class="line">        <span class="keyword">return</span> x&gt;M||y&gt;N||x&lt;<span class="number">0</span>||y&lt;<span class="number">0</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_same_color</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{<span class="comment">//&#x6E90;&#x5750;&#x6807;&#x4E0E;&#x76EE;&#x7684;&#x5750;&#x6807;&#x662F;&#x5426;&#x662F;&#x540C;&#x4E00;&#x989C;&#x8272;</span></div><div class="line">        <span class="keyword">return</span> get_color(sx,sy)==get_color(dx,dy);</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">swap_num</span><span class="params">(<span class="keyword">int</span> &amp; num1,<span class="keyword">int</span>&amp; num2)</span> </span>{<span class="comment">//&#x4EA4;&#x6362;&#x4E24;&#x4E2A;&#x6570;</span></div><div class="line">        num1+=num2;</div><div class="line">        num2=num1-num2;</div><div class="line">        num1=num1-num2;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_abs</span><span class="params">(<span class="keyword">int</span> num)</span> </span>{<span class="comment">//&#x53D6;&#x5F97;&#x7EDD;&#x5BF9;&#x503C;</span></div><div class="line">        <span class="keyword">return</span> num&gt;=<span class="number">0</span>?num:-num;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">num_of_not_blank_betweenn</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{<span class="comment">//&#x8FD4;&#x56DE;&#x5728;&#x8D77;&#x59CB;&#x5750;&#x6807;&#x548C;&#x76EE;&#x7684;&#x5750;&#x6807;&#x4E4B;&#x95F4;&#x68CB;&#x5B50;&#x7684;&#x4E2A;&#x6570;</span></div><div class="line">        <span class="keyword">if</span>(!(sx==dx||sy==dy))<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">        <span class="keyword">int</span> num=<span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(sy&gt;dy)swap_num(sy,dy);</div><div class="line">        <span class="keyword">if</span>(sx&gt;dx)swap_num(sx,dx);</div><div class="line">        <span class="keyword">if</span>(sx==dx) {</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=sy+<span class="number">1</span>; i&lt;dy; i++) {</div><div class="line">                <span class="keyword">if</span>(b[sx][i]!=BLANK)num++;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(sy==dy) {</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=sx+<span class="number">1</span>; i&lt;dx; i++) {</div><div class="line">                <span class="keyword">if</span>(b[i][sy]!=BLANK)num++;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_JU</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">return</span> num_of_not_blank_betweenn(sx,sy,dx,dy)==<span class="number">0</span>;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_MA</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">int</span> x=dx-sx,y=dy-sy;</div><div class="line">        <span class="keyword">if</span>(get_abs(x)==<span class="number">2</span>&amp;&amp;get_abs(y)==<span class="number">1</span>) {</div><div class="line">            <span class="keyword">if</span>(get_color(sx+x/<span class="number">2</span>,sy)==BLANK)<span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//&#x784C;&#x9A6C;&#x8E44;&#x68C0;&#x6D4B;</span></div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(get_abs(x)==<span class="number">1</span>&amp;&amp;get_abs(y)==<span class="number">2</span>) {</div><div class="line">            <span class="keyword">if</span>(get_color(sx,sy+y/<span class="number">2</span>)==BLANK)<span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//&#x784C;&#x9A6C;&#x8E44;&#x68C0;&#x6D4B;</span></div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_XIANG</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">int</span> x=dx-sx,y=dy-sy;</div><div class="line">        <span class="keyword">if</span>(!(get_abs(x)==<span class="number">2</span>&amp;&amp;get_abs(y)==<span class="number">2</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(get_color(sx+x/<span class="number">2</span>,sy+y/<span class="number">2</span>)==BLANK)<span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//&#x784C;&#x8C61;&#x8E44;&#x68C0;&#x6D4B;</span></div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_SHI</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">int</span> x=dx-sx,y=dy-sy;</div><div class="line">        <span class="keyword">if</span>(!(get_abs(x)==<span class="number">1</span>&amp;&amp;get_abs(y)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(dx&lt;<span class="number">7</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(dy&lt;<span class="number">3</span>||dy&gt;<span class="number">5</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_JIANG</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">int</span> x=dx-sx,y=dy-sy;</div><div class="line">        <span class="keyword">if</span>(!((get_abs(x)==<span class="number">1</span>&amp;&amp;get_abs(y)==<span class="number">0</span>)||(get_abs(x)==<span class="number">0</span>&amp;&amp;get_abs(y)==<span class="number">1</span>))) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(dx&lt;<span class="number">7</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(dy&lt;<span class="number">3</span>||dy&gt;<span class="number">5</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; i++) {<span class="comment">//&#x660E;&#x5C06;&#x68C0;&#x6D4B;</span></div><div class="line">            <span class="keyword">if</span>(get_type(i,dy)==JIANG) {</div><div class="line">                <span class="keyword">if</span>(num_of_not_blank_betweenn(dx,dy,i,dy)==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_PAO</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">int</span> n=get_color(dx,dy)==BLANK?<span class="number">0</span>:<span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> num_of_not_blank_betweenn(sx,sy,dx,dy)==n;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move_ZU</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">if</span>(dx&gt;sx)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">int</span> x=dx-sx,y=dy-sy;</div><div class="line">        <span class="keyword">if</span>(get_abs(x)+get_abs(y)!=<span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(sx&gt;<span class="number">4</span>&amp;&amp;get_abs(x)!=<span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//&#x8FC7;&#x6CB3;&#x524D;&#x53EA;&#x80FD;&#x5411;&#x524D;&#x8D70;</span></div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_correct_move</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">if</span>(sx==dx&amp;&amp;sy==dy) {</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(is_out(sx,sy)||is_out(dx,dy)) {</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(get_color(sx,sy)!=color) {</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(is_same_color(sx,sy,dx,dy)) {</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">switch</span>(get_type(sx,sy)) {</div><div class="line">        <span class="keyword">case</span> JU:</div><div class="line">            <span class="keyword">return</span> is_correct_move_JU(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">case</span> MA:</div><div class="line">            <span class="keyword">return</span> is_correct_move_MA(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">case</span> XIANG:</div><div class="line">            <span class="keyword">return</span> is_correct_move_XIANG(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">case</span> SHI:</div><div class="line">            <span class="keyword">return</span> is_correct_move_SHI(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">case</span> JIANG:</div><div class="line">            <span class="keyword">return</span> is_correct_move_JIANG(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">case</span> PAO:</div><div class="line">            <span class="keyword">return</span> is_correct_move_PAO(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">case</span> ZU:</div><div class="line">            <span class="keyword">return</span> is_correct_move_ZU(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">move_s_to_d</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{ <span class="comment">//&#x79FB;&#x52A8;&#x64CD;&#x4F5C;</span></div><div class="line">        <span class="keyword">if</span>(get_type(dx,dy)==JIANG) {    <span class="comment">//&#x5982;&#x679C;&#x76EE;&#x7684;&#x68CB;&#x5B50;&#x662F;&#x5C06;</span></div><div class="line">            <span class="keyword">if</span>(get_color(dx,dy)==color)set_win(LOSE);<span class="comment">//&#x5982;&#x679C;&#x662F;&#x81EA;&#x5DF1;&#x7684;&#x5C06;&#xFF0C;&#x5219;&#x8F93;</span></div><div class="line">            <span class="keyword">else</span> set_win(WIN);<span class="comment">//&#x5982;&#x679C;&#x662F;&#x5BF9;&#x65B9;&#x7684;&#x5C06;&#xFF0C;&#x5219;&#x8D62;</span></div><div class="line">        }</div><div class="line">        b[dx][dy]=b[sx][sy];</div><div class="line">        b[sx][sy]=BLANK;</div><div class="line">        change_turn();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init_pieces</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;M; i+=M<span class="number">-1</span>) {<span class="comment">//&#x7B2C;&#x4E00;&#x884C;&#x548C;&#x6700;&#x540E;&#x4E00;&#x884C;&#xFF08;&#x5373;&#x8F66;&#x9A6C;&#x8C61;&#x58EB;&#x5C06;&#x58EB;&#x8C61;&#x9A6C;&#x8F66;&#xFF09;</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> index=<span class="number">0</span>; index&lt;N; index++) {</div><div class="line">                <span class="keyword">if</span>(index&lt;N/<span class="number">2</span>+<span class="number">1</span>)b[i][index]=index+<span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span> b[i][index]=N-index;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="comment">//&#x5352;&#x6240;&#x5728;&#x7684;&#x884C;</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> index=<span class="number">0</span>; index&lt;N; index+=<span class="number">2</span>) {</div><div class="line">            b[<span class="number">3</span>][index]=ZU;</div><div class="line">        }</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> index=<span class="number">0</span>; index&lt;N; index+=<span class="number">2</span>) {</div><div class="line">            b[<span class="number">6</span>][index]=ZU;</div><div class="line">        }</div><div class="line">        b[<span class="number">2</span>][<span class="number">1</span>]=PAO;</div><div class="line">        b[M<span class="number">-1</span><span class="number">-2</span>][<span class="number">1</span>]=PAO;</div><div class="line">        b[<span class="number">2</span>][N<span class="number">-1</span><span class="number">-1</span>]=PAO;</div><div class="line">        b[M<span class="number">-1</span><span class="number">-2</span>][N<span class="number">-1</span><span class="number">-1</span>]=PAO;</div><div class="line">        <span class="keyword">int</span> s,d;<span class="comment">//&#x5B58;&#x50A8;&#x8D77;&#x59CB;&#x884C;&#x548C;&#x7EC8;&#x70B9;&#x884C;</span></div><div class="line">        <span class="keyword">if</span>(color==BLACK) {</div><div class="line">            s=<span class="number">0</span>;<span class="comment">//&#x4ECE;0&#x884C;&#x5230;M/2&#x884C;&#xFF0C;&#x5373;&#x68CB;&#x76D8;&#x4E0A;&#x534A;&#x90E8;&#x5206;</span></div><div class="line">            d=M/<span class="number">2</span>;</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            s=M/<span class="number">2</span>;<span class="comment">//&#x68CB;&#x76D8;&#x4E0B;&#x534A;&#x90E8;&#x5206;</span></div><div class="line">            d=M;</div><div class="line">        }</div><div class="line">        <span class="comment">//&#x4ECE;s&#x884C;&#x5230;d&#x884C;&#xFF0C;&#x628A;&#x975E;BLANK&#x7684;&#x503C;&#x52A0;BLANK&#xFF0C;&#x4F7F;&#x5C0F;&#x4E8E;BLANK&#x7684;&#x4EE3;&#x8868;&#x9ED1;&#x8272;&#x68CB;&#xFF0C;&#x5927;&#x4E8E;BLANK&#x7684;&#x4EE3;&#x8868;&#x767D;&#x8272;&#x68CB;</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> index=s; index&lt;d; index++) {</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;N; j++) {</div><div class="line">                <span class="keyword">if</span>(b[index][j]!=BLANK) {</div><div class="line">                    b[index][j]+=BLANK;</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Board(<span class="keyword">int</span> c) {</div><div class="line">        color=c;</div><div class="line">        M=<span class="number">10</span>;</div><div class="line">        N=<span class="number">9</span>;</div><div class="line">        b=<span class="keyword">new</span> <span class="keyword">int</span>*[M];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;M; i++) {</div><div class="line">            b[i]=<span class="keyword">new</span> <span class="keyword">int</span>[N];</div><div class="line">        }</div><div class="line">        init();</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{<span class="comment">//&#x68CB;&#x76D8;&#x521D;&#x59CB;&#x5316;</span></div><div class="line">        is_win=<span class="number">0</span>;</div><div class="line">        turn=color==BLACK?<span class="literal">true</span>:<span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;M; i++) {</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;N; j++) {</div><div class="line">                b[i][j]=BLANK;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        init_pieces();</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_M</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">return</span> M;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_N</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">return</span> N;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_color</span><span class="params">()</span> </span>{<span class="comment">//&#x83B7;&#x53D6;&#x5DF1;&#x65B9;&#x7684;&#x989C;&#x8272;</span></div><div class="line">        <span class="keyword">return</span> color;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_color</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>{<span class="comment">//&#x83B7;&#x53D6;&#x68CB;&#x76D8;&#x67D0;&#x4E00;&#x5750;&#x6807;&#x4E0A;&#x68CB;&#x5B50;&#x7684;&#x989C;&#x8272;</span></div><div class="line">        <span class="keyword">return</span> b[x][y]&gt;BLANK?WHITE:b[x][y]&lt;BLANK?BLACK:BLANK;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_type</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>{<span class="comment">//&#x83B7;&#x53D6;&#x68CB;&#x5B50;&#x7C7B;&#x578B;&#xFF08;&#x7A7A;&#x3001;&#x8F66;&#x3001;&#x9A6C;&#x3001;&#x8C61;&#x3001;&#x58EB;&#x3001;&#x5C06;&#x3001;&#x70AE;&#x3001;&#x5352;&#xFF09;</span></div><div class="line">        <span class="keyword">return</span> b[x][y]!=BLANK?b[x][y]%BLANK:BLANK;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_win</span><span class="params">(<span class="keyword">int</span> is)</span> </span>{</div><div class="line">        is_win=is;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_is_win</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">return</span> is_win;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">change_turn</span><span class="params">()</span> </span>{</div><div class="line">        turn=turn==<span class="literal">true</span>?<span class="literal">false</span>:<span class="literal">true</span>;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_my_turn</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">return</span> turn;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">othside_move_piece</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{<span class="comment">//&#x5BF9;&#x65B9;&#x79FB;&#x5B50;</span></div><div class="line">        sx=M<span class="number">-1</span>-sx;<span class="comment">//&#x5148;&#x8FDB;&#x884C;&#x5750;&#x6807;&#x8F6C;&#x6362;&#xFF0C;&#x56E0;&#x5BF9;&#x65B9;&#x89C6;&#x89D2;&#x4E0E;&#x5DF1;&#x65B9;&#x76F8;&#x53CD;</span></div><div class="line">        sy=N<span class="number">-1</span>-sy;</div><div class="line">        dx=M<span class="number">-1</span>-dx;</div><div class="line">        dy=N<span class="number">-1</span>-dy;</div><div class="line">        move_s_to_d(sx,sy,dx,dy);</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">my_move_piece</span><span class="params">(<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{       <span class="comment">//&#x5DF1;&#x65B9;&#x4E3B;&#x52A8;&#x79FB;&#x5B50;</span></div><div class="line">        <span class="keyword">if</span>(!is_correct_move(sx,sy,dx,dy))<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        move_s_to_d(sx,sy,dx,dy);</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// CHINESE_CHESS_H_INCLUDED</span></span></div></pre></td></tr></table></figure>
<h3 id="server">Server.h</h3>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> SERVER_H_INCLUDED</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SERVER_H_INCLUDED</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winsock2.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;chinese_chess.h&quot;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INIT_ERROR 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BIND_ERROR 2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LISTEN_ERROR 3</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> CONNECT_ERROR 4</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SEND_ERROR 5</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ACCEPT_ERROR 6</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ALIVE_ERROR 7</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> THREAD_ERROR 8</span></div><div class="line"><span class="keyword">int</span> error_num;</div><div class="line"><span class="keyword">extern</span> HWND hwnd;</div><div class="line"><span class="keyword">extern</span> Board* chess_board;</div><div class="line"><span class="keyword">extern</span> <span class="keyword">char</span>* ots_ip;</div><div class="line"><span class="keyword">extern</span> <span class="keyword">int</span> port;</div><div class="line"><span class="keyword">extern</span> <span class="keyword">bool</span> is_connect_alive;</div><div class="line"></div><div class="line"><span class="comment">//&#x7EBF;&#x7A0B;&#x53C2;&#x6570;&#x7ED3;&#x6784;&#x4F53;</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> server_args {</div><div class="line">    SOCKET* Com_Sock;</div><div class="line">    <span class="keyword">char</span> * rebuf;</div><div class="line">} server_args;</div><div class="line"><span class="comment">//&#x6821;&#x9A8C;&#x68C0;&#x6D4B;&#xFF0C;&#x4E0E;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x6DFB;&#x52A0;&#x6821;&#x9A8C;&#x662F;&#x76F8;&#x53CD;&#x64CD;&#x4F5C;</span></div><div class="line"><span class="comment">//&#x6700;&#x540E;&#x4E00;&#x4F4D;&#x4E4B;&#x524D;&#x7684;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x76F8;&#x52A0;&#x53D6;&#x6A21;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x7B49;&#x4E8E;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5219;&#x6821;&#x9A8C;&#x901A;&#x8FC7;</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">server_check</span><span class="params">(<span class="keyword">char</span> * r)</span> </span>{</div><div class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(r);</div><div class="line">    len--;</div><div class="line">    <span class="keyword">int</span> s=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++) {</div><div class="line">        s+=r[i];</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span>(r[len]==(s%<span class="number">5</span>+<span class="string">&apos;0&apos;</span>)) {</div><div class="line">        r[len]=<span class="string">&apos;\0&apos;</span>;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">}</div><div class="line"><span class="comment">//&#x9519;&#x8BEF;&#x5904;&#x7406;&#xFF0C;is_tell&#x63A7;&#x5236;&#x662F;&#x5426;&#x663E;&#x793A;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#xFF0C;is_exit&#x63A7;&#x5236;&#x662F;&#x5426;&#x9000;&#x51FA;&#x7A0B;&#x5E8F;</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">handle_error</span><span class="params">(<span class="keyword">int</span> err,<span class="keyword">bool</span> is_tell,<span class="keyword">bool</span> is_exit)</span> </span>{</div><div class="line">    error_num=err;</div><div class="line">    <span class="keyword">if</span>(!is_tell)<span class="keyword">return</span> error_num;</div><div class="line">    <span class="keyword">char</span> error[<span class="number">30</span>]=<span class="string">&quot;&quot;</span>;</div><div class="line">    <span class="keyword">switch</span>(error_num) {</div><div class="line">    <span class="keyword">case</span> INIT_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x521D;&#x59CB;&#x5316;&#x9519;&#x8BEF;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> BIND_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x7ED1;&#x5B9A;&#x7AEF;&#x53E3;&#x9519;&#x8BEF;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> LISTEN_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x76D1;&#x542C;&#x9519;&#x8BEF;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> ACCEPT_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#x9519;&#x8BEF;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> CONNECT_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x65E0;&#x6CD5;&#x8FDE;&#x63A5;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> ALIVE_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x8FDE;&#x63A5;&#x5DF2;&#x65AD;&#x5F00;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> THREAD_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x7EBF;&#x7A0B;&#x65E0;&#x6CD5;&#x521B;&#x5EFA;&quot;</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> SEND_ERROR:</div><div class="line">        <span class="built_in">strcpy</span>(error,<span class="string">&quot;&#x53D1;&#x9001;&#x9519;&#x8BEF;&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">char</span> error_message[<span class="number">50</span>];</div><div class="line">    <span class="built_in">strcpy</span>(error_message,<span class="string">&quot;&#x9519;&#x8BEF;&#xFF1A;&quot;</span>);</div><div class="line">    <span class="built_in">strcat</span>(error_message,error);</div><div class="line">    <span class="keyword">if</span>(is_exit)<span class="built_in">strcat</span>(error_message,<span class="string">&quot;\n&#x7A0B;&#x5E8F;&#x5C06;&#x9000;&#x51FA;&#x3002;&quot;</span>);</div><div class="line">    MessageBox(hwnd,error_message,<span class="string">&quot;&#x9519;&#x8BEF;&quot;</span>,MB_OK);</div><div class="line">    <span class="keyword">if</span>(is_exit)<span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">    <span class="keyword">return</span> error_num;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span>* <span class="title">handle_message</span><span class="params">(<span class="keyword">void</span>*ar)</span> </span>{</div><div class="line">    server_args * serarg=(server_args * )ar;</div><div class="line">    <span class="keyword">char</span> *recv=serarg-&gt;rebuf;</div><div class="line">    SOCKET* CommandSock=serarg-&gt;Com_Sock;</div><div class="line">    <span class="keyword">if</span>(server_check(recv)) {<span class="comment">//&#x6821;&#x9A8C;&#x901A;&#x8FC7;&#x53D1;&#x9001;okok&#xFF08;OK&#xFF09;&#xFF0C;&#x4E0D;&#x901A;&#x8FC7;&#x53D1;&#x9001;noto&#xFF08;NOTOK&#xFF09;</span></div><div class="line">        send(*CommandSock,<span class="string">&quot;okok&quot;</span>,<span class="number">4</span>,<span class="number">0</span>);</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        send(*CommandSock,<span class="string">&quot;noto&quot;</span>,<span class="number">4</span>,<span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> ar;</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span>(<span class="built_in">strncmp</span>(recv,<span class="string">&quot;move&quot;</span>,<span class="number">4</span>)==<span class="number">0</span>) {</div><div class="line">        <span class="keyword">char</span> * pch;</div><div class="line">        <span class="comment">//&#x5C06;recvBuf&#x4EE5;&#x9017;&#x53F7;&#x62C6;&#x5206;</span></div><div class="line">        pch = strtok (recv,<span class="string">&quot;,&quot;</span>);</div><div class="line">        pch = strtok (<span class="literal">NULL</span>,<span class="string">&quot;,&quot;</span>);</div><div class="line">        <span class="keyword">int</span> xys[<span class="number">4</span>];</div><div class="line">        <span class="keyword">int</span> index=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (pch != <span class="literal">NULL</span>) {</div><div class="line">            xys[index]=atoi(pch);<span class="comment">//char* &#x8F6C;&#x6362;&#x4E3A;int</span></div><div class="line">            index++;</div><div class="line">            pch = strtok (<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>);</div><div class="line">        }</div><div class="line">        chess_board-&gt;othside_move_piece(xys[<span class="number">0</span>],xys[<span class="number">1</span>],xys[<span class="number">2</span>],xys[<span class="number">3</span>]);</div><div class="line">        <span class="keyword">if</span>(chess_board-&gt;get_is_win()==LOSE) {</div><div class="line">            chess_board-&gt;init();<span class="comment">//&#x5982;&#x679C;&#x8F93;&#x4E86;&#xFF0C;&#x5219;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x68CB;&#x76D8;&#xFF0C;&#x518D;&#x4E0B;&#x4E00;&#x76D8;</span></div><div class="line">            MessageBox(hwnd,<span class="string">&quot;&#x4F60;&#x8F93;&#x4E86;&quot;</span>,<span class="string">&quot;&#x5931;&#x8D25;&#xFF01;&quot;</span>,<span class="literal">NULL</span>);</div><div class="line">        }</div><div class="line">        InvalidateRect(hwnd,<span class="literal">NULL</span>,<span class="literal">true</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">delete</span> recv;</div><div class="line">}</div><div class="line"><span class="keyword">class</span> Server {</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    SOCKET Server_Sock;</div><div class="line">    SOCKADDR_IN server_addr;</div><div class="line">    SOCKADDR_IN client_addr;</div><div class="line">    <span class="keyword">char</span> recvBuf[<span class="number">20</span>];</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Server() {</div><div class="line">        WSADATA wsa;</div><div class="line">        <span class="comment">/*&#x521D;&#x59CB;&#x5316;socket&#x8D44;&#x6E90;*/</span></div><div class="line">        <span class="keyword">if</span> (WSAStartup(MAKEWORD(<span class="number">1</span>,<span class="number">1</span>),&amp;wsa) != <span class="number">0</span>) {</div><div class="line">            handle_error(INIT_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">if</span>((Server_Sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>))==<span class="number">-1</span>) {</div><div class="line">            handle_error(INIT_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        }</div><div class="line">        ZeroMemory((<span class="keyword">char</span> *)&amp;server_addr,<span class="keyword">sizeof</span>(server_addr));</div><div class="line">        server_addr.sin_family = AF_INET;</div><div class="line">        server_addr.sin_port = htons(port);           <span class="comment">/*&#x672C;&#x5730;&#x76D1;&#x542C;&#x7AEF;&#x53E3;*/</span></div><div class="line">        server_addr.sin_addr.s_addr = htonl(INADDR_ANY); <span class="comment">/*&#x6709;IP*/</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span>(bind(Server_Sock,(<span class="keyword">struct</span> sockaddr *)&amp;server_addr,<span class="keyword">sizeof</span>(server_addr))==<span class="number">-1</span>) {</div><div class="line">            handle_error(BIND_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(listen(Server_Sock,<span class="number">5</span>)==<span class="number">-1</span>) { <span class="comment">//&#x5176;&#x4E2D;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x4EE3;&#x8868;&#x80FD;&#x591F;&#x63A5;&#x6536;&#x7684;&#x6700;&#x591A;&#x7684;&#x8FDE;&#x63A5;&#x6570;</span></div><div class="line">            handle_error(LISTEN_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        }</div><div class="line">        <span class="built_in">strcpy</span>(recvBuf,<span class="string">&quot;&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">listen_message</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">int</span> len=<span class="keyword">sizeof</span>(SOCKADDR);</div><div class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) {</div><div class="line">            SOCKET Command_Sock  = accept(Server_Sock, (SOCKADDR*)&amp;client_addr,&amp;len);</div><div class="line">            <span class="keyword">if</span>(Command_Sock == INVALID_SOCKET) {</div><div class="line">                closesocket(Command_Sock);</div><div class="line">                handle_error(ACCEPT_ERROR,<span class="literal">false</span>,<span class="literal">false</span>);</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            }</div><div class="line">            <span class="keyword">if</span>(client_addr.sin_addr.s_addr!=inet_addr(ots_ip)) {<span class="comment">//&#x5982;&#x679C;&#x63A5;&#x6536;&#x7684;socket&#x4E0D;&#x662F;&#x9884;&#x671F;&#x7684;&#x5BF9;&#x65B9;&#x7684;&#xFF0C;&#x5219;&#x53D1;&#x9001;wron&#xFF0C;&#x7EE7;&#x7EED;&#x7B49;&#x5F85;</span></div><div class="line">                send(Command_Sock,<span class="string">&quot;wron&quot;</span>,<span class="number">4</span>,<span class="number">0</span>);</div><div class="line">                closesocket(Command_Sock);</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            }</div><div class="line">            send(Command_Sock,<span class="string">&quot;righ&quot;</span>,<span class="number">4</span>,<span class="number">0</span>);</div><div class="line">            is_connect_alive=<span class="literal">true</span>;</div><div class="line">            <span class="keyword">while</span>(<span class="literal">true</span>) {</div><div class="line">                <span class="keyword">if</span>(recv(Command_Sock,recvBuf,<span class="number">20</span>,<span class="number">0</span>)&lt;=<span class="number">0</span>) {<span class="comment">//recv&#x8FD4;&#x56DE;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;0&#x7684;&#x503C;&#xFF0C;&#x5219;&#x8FDE;&#x63A5;&#x5DF2;&#x65AD;&#x5F00;</span></div><div class="line">                    handle_error(ALIVE_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">                    closesocket(Command_Sock);</div><div class="line">                    close();</div><div class="line">                    <span class="keyword">return</span> ;</div><div class="line">                }</div><div class="line">                <span class="keyword">char</span> *rbuf=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">20</span>];</div><div class="line">                <span class="built_in">strcpy</span>(rbuf,recvBuf);</div><div class="line">                server_args serarg;</div><div class="line">                serarg.Com_Sock=&amp;Command_Sock;</div><div class="line">                serarg.rebuf=rbuf;</div><div class="line">                <span class="keyword">pthread_t</span> handle_m;</div><div class="line">                <span class="keyword">int</span> ret;</div><div class="line">                ret= pthread_create( &amp;handle_m,  <span class="literal">NULL</span>, handle_message,&amp;serarg); <span class="comment">//</span></div><div class="line">                <span class="keyword">if</span>( ret != <span class="number">0</span> ) { <span class="comment">//&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6210;&#x529F;&#x8FD4;&#x56DE;0</span></div><div class="line">                    <span class="comment">// printf(&quot;pthread_create error:error_code=%d\n&quot;,ret );</span></div><div class="line">                    handle_error(THREAD_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">                    <span class="keyword">return</span> ;</div><div class="line">                }</div><div class="line">                <span class="built_in">strcpy</span>(recvBuf,<span class="string">&quot;&quot;</span>);</div><div class="line">            }</div><div class="line">            closesocket(Command_Sock);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</div><div class="line">        closesocket(Server_Sock);</div><div class="line">        WSACleanup();</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// SERVER_H_INCLUDED</span></span></div></pre></td></tr></table></figure>
<h3 id="client">Client.h</h3>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> CLIENT_H_INCLUDED</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> CLIENT_H_INCLUDED</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winsock2.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;chinese_chess.h&quot;</span></span></div><div class="line"></div><div class="line"><span class="comment">//&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x6DFB;&#x52A0;&#x6821;&#x9A8C;&#x4FE1;&#x606F;&#xFF0C;&#x5BF9;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x6C42;&#x548C;&#xFF0C;&#x6A21;5&#x4E4B;&#x540E;&#x8F6C;&#x5316;&#x4E3A;&#x5B57;&#x7B26;&#x653E;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x6700;&#x540E;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">client_check</span><span class="params">(<span class="keyword">char</span>* r)</span> </span>{</div><div class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(r);</div><div class="line">    <span class="keyword">int</span> s=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++) {</div><div class="line">        s+=r[i];</div><div class="line">    }</div><div class="line">    r[len]=s%<span class="number">5</span>+<span class="string">&apos;0&apos;</span>;</div><div class="line">    r[len+<span class="number">1</span>]=<span class="string">&apos;\0&apos;</span>;</div><div class="line">}</div><div class="line"><span class="keyword">class</span> Client {</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    SOCKET Client_Sock;</div><div class="line">    SOCKADDR_IN server_addr;</div><div class="line">    <span class="keyword">char</span> sendBuf[<span class="number">20</span>];</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Client() {</div><div class="line">        WSADATA wsa;</div><div class="line">        <span class="comment">/*&#x521D;&#x59CB;&#x5316;socket&#x8D44;&#x6E90;*/</span></div><div class="line">        <span class="keyword">if</span> (WSAStartup(MAKEWORD(<span class="number">1</span>,<span class="number">1</span>),&amp;wsa) != <span class="number">0</span>) {</div><div class="line">            handle_error(INIT_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">return</span>;   <span class="comment">//&#x4EE3;&#x8868;&#x5931;&#x8D25;</span></div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>((Client_Sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>))==<span class="number">-1</span>) {</div><div class="line">            handle_error(INIT_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            <span class="keyword">return</span>;   <span class="comment">//&#x4EE3;&#x8868;&#x5931;&#x8D25;</span></div><div class="line">        }</div><div class="line">        server_addr.sin_addr.S_un.S_addr=inet_addr(ots_ip);</div><div class="line">        server_addr.sin_family=AF_INET;</div><div class="line">        server_addr.sin_port=htons(port);</div><div class="line">        <span class="built_in">strcpy</span>(sendBuf,<span class="string">&quot;&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">connect_to_ots</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">while</span>(connect(Client_Sock,(SOCKADDR*)&amp;server_addr,<span class="keyword">sizeof</span>(SOCKADDR)) ==<span class="number">-1</span>) {</div><div class="line">            handle_error(CONNECT_ERROR,<span class="literal">false</span>,<span class="literal">false</span>);</div><div class="line">            Sleep(<span class="number">100</span>);</div><div class="line">            <span class="comment">//printf( &quot;%d &quot;, WSAGetLastError());</span></div><div class="line">        }</div><div class="line">        <span class="keyword">char</span> rec[<span class="number">5</span>];</div><div class="line">        recv(Client_Sock,rec,<span class="number">4</span>,<span class="number">0</span>);</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">strncmp</span>(rec,<span class="string">&quot;wron&quot;</span>,<span class="number">4</span>)==<span class="number">0</span>) {  <span class="comment">//&#x6536;&#x5230;wrong&#xFF0C;&#x8BF4;&#x660E;&#x5BF9;&#x65B9;&#x6240;&#x8F93;&#x5165;&#x7684;IP&#x4E0D;&#x662F;&#x5DF1;&#x65B9;IP</span></div><div class="line">            MessageBox(hwnd,<span class="string">&quot;&#x5BF9;&#x65B9;&#x8F93;&#x5165;&#x7684;IP&#x4E0D;&#x662F;&#x4F60;\n&#x7A0B;&#x5E8F;&#x5C06;&#x9000;&#x51FA;&quot;</span>,<span class="string">&quot;&#x9519;&#x8BEF;&quot;</span>,<span class="literal">NULL</span>);</div><div class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);</div><div class="line">        }</div><div class="line">        <span class="comment">//&#x8C01;&#x5148;&#x8FDE;&#x63A5;&#x8C01;&#x662F;&#x9ED1;&#x8272;</span></div><div class="line">        <span class="comment">//&#x5982;&#x679C;server&#x5DF2;&#x7ECF;&#x6536;&#x5230;&#x8FDE;&#x63A5;&#xFF0C;&#x5219;&#x8BF4;&#x660E;&#x662F;&#x5BF9;&#x65B9;&#x5148;&#x8FDE;&#x63A5;&#x81EA;&#x5DF1;&#xFF0C;&#x5219;&#x81EA;&#x5DF1;&#x5E94;&#x4E3A;&#x767D;&#x8272;&#xFF0C;&#x5426;&#x5219;&#x81EA;&#x5DF1;&#x662F;&#x9ED1;&#x8272;</span></div><div class="line">        <span class="keyword">if</span>(is_connect_alive) {</div><div class="line">            chess_board=<span class="keyword">new</span> Board(WHITE);</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            chess_board=<span class="keyword">new</span> Board(BLACK);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</div><div class="line">        closesocket(Client_Sock);</div><div class="line">        WSACleanup();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">send_message</span><span class="params">(<span class="keyword">char</span> * message)</span> </span>{</div><div class="line">        <span class="built_in">strcpy</span>(sendBuf,message);</div><div class="line">        client_check(sendBuf);</div><div class="line">        <span class="keyword">int</span> len;</div><div class="line">        <span class="keyword">int</span> try_time=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) {</div><div class="line">            len=send(Client_Sock,sendBuf,<span class="built_in">strlen</span>(sendBuf)+<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">            <span class="keyword">if</span>(len!=(<span class="built_in">strlen</span>(sendBuf)+<span class="number">1</span>)) {</div><div class="line">                handle_error(SEND_ERROR,<span class="literal">false</span>,<span class="literal">false</span>);</div><div class="line">                <span class="comment">//printf( &quot;%d &quot;, WSAGetLastError());</span></div><div class="line">            }</div><div class="line">            <span class="keyword">char</span> rec[<span class="number">5</span>];</div><div class="line">            recv(Client_Sock,rec,<span class="number">4</span>,<span class="number">0</span>);</div><div class="line">            <span class="keyword">if</span>(<span class="built_in">strncmp</span>(rec,<span class="string">&quot;okok&quot;</span>,<span class="number">4</span>)==<span class="number">0</span>) {<span class="comment">//&#x6536;&#x5230;OK&#x8BF4;&#x660E;&#x6570;&#x636E;&#x5DF2;&#x7ECF;&#x6B63;&#x786E;&#x88AB;&#x5BF9;&#x65B9;&#x6536;&#x5230;</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            }</div><div class="line">            <span class="keyword">if</span>(try_time&gt;<span class="number">20</span>) {   <span class="comment">//&#x5C1D;&#x8BD5;20&#x6B21;&#xFF0C;&#x6570;&#x636E;&#x4ECD;&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x9001;&#x8FBE;&#xFF0C;&#x5219;&#x9000;&#x51FA;</span></div><div class="line">                handle_error(SEND_ERROR,<span class="literal">true</span>,<span class="literal">true</span>);</div><div class="line">            }</div><div class="line">            try_time++;</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> len;</div><div class="line">    }</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">send_message</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> * message,<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy)</span> </span>{</div><div class="line">        <span class="keyword">char</span>* message_temp=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">20</span>];</div><div class="line">        <span class="built_in">sprintf</span>(message_temp,<span class="string">&quot;%s,%d,%d,%d,%d,&quot;</span>,message,sx,sy,dx,dy);</div><div class="line">        <span class="keyword">int</span> len=send_message(message_temp);</div><div class="line">        <span class="keyword">delete</span> message_temp;</div><div class="line">        <span class="keyword">return</span> len;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// CLIENT_H_INCLUDED</span></span></div></pre></td></tr></table></figure>
<ul class="ui list">
<li>&#x8BE5;&#x7A0B;&#x5E8F;&#x4ECE;3.15&#x665A;&#x5F00;&#x59CB;&#xFF0C;&#x7528;&#x4E86;&#x56DB;&#x5929;&#x7684;&#x7A7A;&#x95F2;&#x65F6;&#x95F4;&#x3002;</li>
</ul>

                        
                    </div>

                    
                    
                    

                    <div class="description post-description">
    <span class="post-description-item">
        <time datetime="2016-03-22T11:01:59.000Z" itemprop="datePublished">2016-03-22</time>

    </span>
    <span class="post-description-item">
        

    <span>
        <i class="tags icon"></i>
    </span>

    
    <span class="ui tiny label">
        <a href="/tags/小游戏/">小游戏</a>
    </span>

    
    <span class="ui tiny label">
        <a href="/tags/网络编程/">网络编程</a>
    </span>

    

    </span>
</div>

                </div>
                
                <div id="pagination" class="nav-web ui text container pagination">

    <div class="ui stackable two column divided grid container">
        <div class="row">
            <div class="column nav-left">
                

                <a href="/2016/04/12/FlappyBird/" class="ui tiny button">

                    <i class="angle left icon"></i>
                    
                    Flappy Bird (Java实现)
                    

                </a>

                
            </div>
            <div class="column nav-right">
                

                <a href="/2016/03/20/Shell实现/" class="ui tiny button">
                    
                    Shell（C++实现，CodeBlocks+GCC编译）
                    
                    <i class="angle right icon"></i></a>
                
            </div>
        </div>
    </div>

</div>
                
            </div>

            
            <div class="three wide computer three wide tablet column">

                <div class="ui sticky article-toc" id="article-toc">
                    <!-- toc -->
                    <ol class="ui ordered list"><li><a href="#chengguo"><span>成果</span></a><ol><li><a href="#xiaoguo"><span>运行效果图</span></a></li></ol></li><li><a href="#guocheng"><span>过程</span></a><ol><li><a href="#liangduan"><span>1.首先的问题是下棋的两端应该是什么样的？</span></a></li><li><a href="#cunchu"><span>2.接下来的问题是怎么表示，怎么存储？</span></a></li><li><a href="#tongxin"><span>3.然后应该怎么通信呢？</span></a></li></ol></li><li><a href="#daima"><span>代码</span></a><ol><li><a href="#main"><span>main.cpp</span></a></li><li><a href="#chess"><span>chinese_chess.h</span></a></li><li><a href="#server"><span>Server.h</span></a></li><li><a href="#client"><span>Client.h</span></a></li></ol></li></ol>
                </div>

            </div>
            

        </div>
    </div>
</div>


                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
        </div>
        <div class="ui vertical footer segment">
    <div class="ui center aligned container">
        <div class="ui inverted section divider"></div>
        &copy; 2016 <a href="/">maxuewei2</a>,
        Powered by <a href="https://github.com/henryhuang/hexo-theme-aloha" target="_blank">Aloha</a> and <a
                href="http://hexo.io/" target="_blank">Hexo</a>.
    </div>
</div>

    </div>




<!-- scripts list from theme config.yml -->

<script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>

<script src="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch/3.18.1/algoliasearch.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch-helper-js/2.13.0/algoliasearch.helper.min.js"></script>

<script src="/js/semantic-ui-algolia.js"></script>

<script src="/js/aloha-events.js"></script>



</body>
</html>
